% sec0631_01.m
% 1 次遅れ要素のゲインと位相差
% 【Symbolic Math Toolbox が必要】

clear
format compact

disp(' ')
disp('==================================================')
disp(' 1 次遅れ要素のゲインと位相差 ')
disp('==================================================')

syms s
syms w positive
syms T positive     % 時定数 T

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp('   　　　　　            1')
disp(' 1 次遅れ要素 P(s) = ---------')
disp('   　　　　　         1 + T s')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

Ps = 1/(1 + T*s)
% P(s) = 1/(1 + T*s)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 周波数伝達関数 P(jw) ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

Pjw = subs(Ps,s,j*w)
% Pjw = P(j*w)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 実部 a = Re[P(jw)] ')
disp(' 虚部 b = Im[P(jw)] ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

a = real(Pjw)
b = imag(Pjw)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' ゲイン Gg(w) = sqrt(a^2 + b^2)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

Gg = sqrt(a^2 + b^2);
Gg = simplify(expand(Gg))

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 位相差 Gp(w) = atan(b/a) ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

Gp = atan(b/a)
