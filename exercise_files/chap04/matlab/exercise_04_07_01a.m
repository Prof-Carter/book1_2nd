% exercise_04_07_01a.m
% 問題 4.7 (1)：定常位置偏差

clear
format compact

disp(' ')
disp('==================================================')
disp(' 問題 4.7 (1) ')
disp('==================================================')

s = tf('s');

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 制御対象 P(s) = 5/(s^2 + 2*s + 2)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

sysP = 5/(s^2 + 2*s + 2);

for kP = [2 5]

    disp(' ')
    disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
    disp(' コントローラ C(s) = kP')
    disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

    sysC = kP

    disp(' ')
    disp('--------------------------------------------------')
    disp('  Ger(s) = 1/(1 + P(s)*C(s))')
    disp('--------------------------------------------------')

    sysL   = minreal(sysP*sysC);
    sysGer = minreal(1/(1 + sysL))
    
    [numGer denGer] = tfdata(sysGer,'v');
    
    disp(' ')
    disp('--------------------------------------------------')
    disp('  定常位置偏差 e_inf = Ger(0)')
    disp('--------------------------------------------------')

    e_inf = sym(numGer(end)/denGer(end))
end

