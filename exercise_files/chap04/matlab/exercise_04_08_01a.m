% exercise_04_08_01a.m
% 問題 4.8 (1)：単位ステップ外乱に対する定常値

clear
format compact

disp(' ')
disp('==================================================')
disp(' 問題 4.8 (1) ')
disp('==================================================')

s = tf('s');

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 制御対象 P(s) = 5/(s^2 + 2*s + 2)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

sysP = 5/(s^2 + 2*s + 2);

for kP = [2 5]

    disp(' ')
    disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
    disp(' コントローラ C(s) = kP')
    disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

    sysC = kP

    disp(' ')
    disp('--------------------------------------------------')
    disp('  Gyd(s) = P(s)/(1 + P(s)*C(s))')
    disp('--------------------------------------------------')

    sysL   = minreal(sysP*sysC);
    sysGyd = minreal(sysP/(1 + sysL))
    
    [numGyd denGyd] = tfdata(sysGyd,'v');
    
    disp(' ')
    disp('--------------------------------------------------')
    disp('  単位ステップ外乱に対する定常値 y_inf = Gyd(0)')
    disp('--------------------------------------------------')

    y_inf = sym(numGyd(end)/denGyd(end))
end

