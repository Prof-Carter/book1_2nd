% exercise_03_08.m
% 問題 3.8 (2)：RL 回路の定常電流
% 【Symbolic Math Toolbox が必要】

clear
format compact

disp(' ')
disp('==================================================')
disp(' 問題 3.8 (2) ')
disp('==================================================')

syms s
syms t real
syms R L E0 positive

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' i(s) = P(s)e(s), P(s) = 1/(L*s + R)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

Ps = 1/(L*s + R)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' e(t) = E0')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' e(s) = L[e(t)]')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

es = E0/s

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' i(s)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

is = Ps*es
disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' i(s) を部分分数分解')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

is = partfrac(is)   % 省略しても良い

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' ステップ応答 i(t)')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

it = ilaplace(is)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' i(t) の極限値')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

i_inf = limit(it,t,Inf)

disp(' ')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')
disp(' 最終値の定理 yinf = P(0)*E0')
disp('++++++++++++++++++++++++++++++++++++++++++++++++++')

i_inf = subs(Ps,s,0)*E0
